diff -ura a/lib/libpam/openpam_ttyconv.c b/lib/libpam/openpam_ttyconv.c
--- a/lib/libpam/openpam_ttyconv.c	2025-09-14 19:34:07.234000000 +0000
+++ b/lib/libpam/openpam_ttyconv.c	2025-09-14 19:34:58.817000000 +0000
@@ -290,9 +290,6 @@
 
 	if (isatty(STDIN_FILENO)) {
 		fflush(stdout);
-#ifdef HAVE_FPURGE
-		fpurge(stdin);
-#endif
 		ifd = STDIN_FILENO;
 		ofd = STDOUT_FILENO;
 	} else {
